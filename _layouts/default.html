<!DOCTYPE html>
<html lang="en">
  <head>
    {% include head.html %}
  </head>
  <body>

    {% include_cached main-menu-contained-dropdown.html %}

    {% for hash in page.allowed_hashes %}
        <a id="{{ hash }}" style="display: none"></a>
    {% endfor %}

    <div class="container-fluid">

      <div class="row" id="maincontent">
        <div class="nav-docs-mobile d-flex d-lg-none w-100 justify-content-between align-items-center px-4 py-2 border-top border-bottom" data-toggle="collapse" data-target="#sidebarMenu" aria-expanded="false" aria-controls="sidebarMenu">
          <div class="h3 m-0">
            Docs Menu
          </div>
          <div class="sidenav-arrow mr-4"><div class="arrow-down"></div></div>
        </div>
        <nav
          id="sidebarMenu"
          class="col-lg-2 d-lg-block sidebar collapse border-right pt-3 pr-md-0"
        >
          {% include sidebar.html %}
        </nav>

        {% if page.toc == true %}
        {% if page.homepage != true %}
        <!-- Smaller column col-xl-8 -->
        <main role="main" class="col col-lg-8 ml-sm-auto px-lg-5">
        {% endif %}
        {% else %}
        <!-- larger column col-xl-10 -->
        <main role="main" class="ml-sm-auto col-lg-10 px-lg-5">
        {% endif %}
            {{content}}
        </main>
        {% if page.toc == true %}
        <div class="toc-col col-md-2">
            <div class="toc-col-contents">  <!-- lets all elements scroll -->
              <div id="toc-right"></div>
              <div class="cf-5329-area-16738"></div>
            </div>
          </div>
        {% endif %}
      </div>
    </div>

          {% include_cached footer.html %}

    
    <script src="{{ 'js/jquery.cookie.min.js' | relative_url }}"></script>
    <script src="{{ 'js/jquery.navgoco.min.js' | relative_url }}"></script>
    <!-- bs 4.X -->
    <script src="{{'js/bootstrap453.bundle.min.js' | relative_url }}" crossorigin="anonymous"></script>
    <script src="//js.convertflow.co/production/websites/5329.js" defer></script>
    {% if page.name == "search.html" %}
    <script src="{{ 'js/algoliasearchLite.min.js' | relative_url }}"></script>
    <script src="{{ 'js/instantsearch.production.min.js' | relative_url }}"></script>
    <script>
      const queryString = (function() {
        // This function is anonymous, is executed immediately and
        // the return value is assigned to QueryString!
        const query_string = {};
        const query = window.location.search.substring(1);
        const vars = query.split("&");
        for (var i = 0; i < vars.length; i++) {
          const pair = vars[i].split("=");
          // If first entry with this name
          if (typeof query_string[pair[0]] === "undefined") {
            query_string[pair[0]] = decodeURIComponent(pair[1]);
            // If second entry with this name
          } else if (typeof query_string[pair[0]] === "string") {
            const arr = [query_string[pair[0]], decodeURIComponent(pair[1])];
            query_string[pair[0]] = arr;
            // If third or later entry with this name
          } else {
            query_string[pair[0]].push(decodeURIComponent(pair[1]));
          }
        }
        return (query_string.query || "").replace(/\+/g, " ");
      })();
    
      const router = instantsearch.routers.history({
        windowTitle({ category, query }) {
          const queryTitle = query ? `Results for "${query}"` : "Search";
          return queryTitle;
        },
    
        createURL({ qsModule, routeState, location }) {
          const urlParts = location.href.match(/^(.*?)\/search/);
          const baseUrl = `${urlParts ? urlParts[1] : ""}/`;
    
          const queryParameters = {};
          const { query = "", page } = qsModule.parse(location.search.slice(1));
          queryParameters.query = query;
    
          if (page !== 1) {
            queryParameters.page = routeState.page;
          }
    
          const queryString = qsModule.stringify(queryParameters, {
            addQueryPrefix: true,
            arrayFormat: "repeat"
          });
    
          return `${baseUrl}search.html${queryString}`;
        },
    
        parseURL({ qsModule, location }) {
          const pathnameMatches = location.pathname.match(/search\/(.*?)\/?$/);
          const { query = "", page } = qsModule.parse(location.search.slice(1));
    
          return {
            query,
            page
          };
        }
      });
    
      const stateMapping = {
        stateToRoute(uiState) {
          return {
            query: uiState["{{site.algolia.index_name}}"].query,
            page: uiState["{{site.algolia.index_name}}"].page
          };
        },
    
        routeToState(routeState) {
          return {
            // eslint-disable-next-line camelcase
            "{{site.algolia.index_name}}": {
              query: routeState.query,
              page: routeState.page
            }
          };
        }
      };
    
      $("#search-input").val(queryString);
      const searchClient = algoliasearch(
        "{{site.algolia.application_id}}",
        "{{site.algolia.search_api_key}}"
      );
    
      const search = instantsearch({
        indexName: "{{site.algolia.index_name}}",
        routing: {
          router,
          stateMapping
        },
        searchClient
      });
    
      const addToResultsIfPresent = (match) => {
        if(match && match.matchLevel && match.matchLevel !== 'none' && match.value) {
          return (match.value || '') + '<br>';
        }
        return '';
      }
    
      const showResult = ({content, tags, title, html}) => {
        if(content && content.value) {
          return content.value
        }
        return addToResultsIfPresent(title) + addToResultsIfPresent(tags);
      }
    
      // Create the render function
      const renderHits = (renderOptions, isFirstRender) => {
        const { hits, widgetParams } = renderOptions;
        var div = $("<div/>");
        let results = "";
        if (hits.length) {
          results = hits
            .map(
              hit =>
                `<div class="search-item">
              <div class="search-title">
                <a href="${hit.url}">${hit.title}</a>
              </div>
              <div class="search-snippet">${showResult(hit._highlightResult)}</div>
              <div class="search-link">${hit.doc_type}</div>
            </div>`
            )
            .join("");
        } else {
          results = "<p>No results.</p>";
        }
        widgetParams.container.innerHTML = results;
      };
    
      // Create the custom widget
      const customHits = instantsearch.connectors.connectHits(renderHits);
    
      search.addWidgets([
        customHits({
          container: document.querySelector("#search-hits")
        }),
        instantsearch.widgets.stats({
          container: "#search-stats",
          templates: {
            text(data) {
              let count = "";
              if (data.hasManyResults) {
                count += `${data.nbHits} results`;
              } else if (data.hasOneResult) {
                count += `1 result`;
              } else {
                count += `no result`;
              }
              return `${count} found for ‘${queryString}’`;
            }
          }
        }),
        instantsearch.widgets.pagination({
          container: "#search-pages",
          padding: 2,
          showFirst: false,
          showLast: false,
          templates: {
            previous: '<span class="fas fa-chevron-left" />',
            next: '<span class="fas fa-chevron-right" />'
          }
        }),
        instantsearch.widgets.configure({
          hitsPerPage: 10,
          query: queryString
        })
      ]);
    
      // Starting the search
      search.start();
    </script>
    {% endif %}
    
    <script src="{{ 'js/toc.js' | relative_url }}"></script>
    <script src="{{ 'js/cookieUtils.js' | relative_url }}" defer></script>
    <script src="{{ 'js/clipboard.min.js' | relative_url }}" defer></script>
    <script src="{{ 'js/customscripts.js' | relative_url }}"></script>
    <script src="{{ 'js/setDocsContext.js' | relative_url }}"></script>
    <script src="{{ 'js/anchor.js' | relative_url }}"></script>
    {% if page.homepage != true %}
        <script>
          anchors.add('h2, h3, h4, h5');
        </script>
    {% endif %}
    <link rel="preload" href="https://kit.fontawesome.com/4e4d5754e5.js" as="script" />
    <script src="https://kit.fontawesome.com/4e4d5754e5.js" crossorigin="anonymous" defer></script>
    <script src="{{ 'js/tocRightScrollHighlight.js' | relative_url }}"></script>
    
    {% include_cached google_remarketing.html %}
    {% if page.twitter == true %}
      {% include_cached twitter_analytics.html %}
    {% endif %}

  </body>
</html>
